stages:
  # STAGE 1: Data Processing
  data_processing:
    cmd: kedro run --pipeline=data_processing
    deps:
      - data/01_raw/chile_completo_covid_2020.csv
      - data/01_raw/chile_completo_covid_2021.csv
      - data/01_raw/chile_completo_covid_2022.csv
      - src/spaceflights/pipelines/data_processing/
    outs:
      - data/05_model_input/regression_dataset.csv
      - data/05_model_input/classification_dataset.csv
    
  # STAGE 2: Data Science (CORREGIDO - archivos en ubicaciones correctas)
  data_science:
    cmd: kedro run --pipeline=data_science
    deps:
      - data/05_model_input/regression_dataset.csv
      - data/05_model_input/classification_dataset.csv
      - src/spaceflights/pipelines/data_science/
    outs:
      - data/06_models/trained_regression_models.pkl
      - data/06_models/trained_classification_models.pkl
      # REMOVIDO: tuned_regression_results.pkl y tuned_classification_results.pkl 
      # porque NO existen en data/06_models/
    metrics:
      # CORREGIDO: Las métricas están en data/07_model_output/, NO en data/08_reporting/
      - data/07_model_output/regression_metrics.json:
          cache: false
      - data/07_model_output/classification_metrics.json:
          cache: false
      - data/07_model_output/best_models_report.json:
          cache: false
      - data/07_model_output/feature_importance_analysis.json:
          cache: false
  
  # STAGE 3: Reporting (NUEVO - faltaba este stage)
  reporting:
    cmd: kedro run --pipeline=reporting
    deps:
      - data/07_model_output/regression_metrics.json
      - data/07_model_output/classification_metrics.json
      - data/07_model_output/best_models_report.json
    outs:
      - data/08_reporting/tuning_summary.json
      - data/08_reporting/regression_comparison.png
      - data/08_reporting/classification_comparison.png
      - data/08_reporting/summary_dashboard.png
    metrics:
      - data/08_reporting/tuning_summary.json:
          cache: false